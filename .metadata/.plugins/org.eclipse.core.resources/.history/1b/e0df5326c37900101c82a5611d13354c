<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Transfer Receipt</title>

    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons (optional) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">

    <!-- html2pdf.js CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <style>
        th, td {
            text-align: left;
        }
        .receipt-label {
            font-size: 1.5rem;
            color: #fff;
            text-decoration: underline;
        }
        .card-custom {
            max-width: 600px;
        }
    </style>
</head>

<body class="bg-light text-center">

    <div th:insert="~{@{reusable-code/header}}"></div>

    <div class="bg-dark py-4">
        <div class="container">
            <label class="receipt-label">Transfer Money Success</label>

            <div id="receipt-content" class="mt-3 mx-auto card card-custom shadow bg-white">
                <div class="card-header bg-primary text-white fw-bold text-start">
                    <i class="bi bi-receipt-cutoff me-2"></i> Transaction Receipt
                </div>
                <div class="card-body p-4">
                    <table class="table table-bordered table-striped table-hover">
                        <tbody>
                            <tr>
                                <th>Transaction ID</th>
                                <td th:text="${transaction.tid}"></td>
                            </tr>
                            <tr>
                                <th>From Account</th>
                                <td th:text="${transaction.fromaccount}"></td>
                            </tr>
                            <tr>
                                <th>Sender</th>
                                <td th:text="${session.username}"></td>
                            </tr>
                            <tr>
                                <th>To Account</th>
                                <td th:text="${transaction.toaccount}"></td>
                            </tr>
                            <tr>
                                <th>Receiver</th>
                                <td th:text="${session.rname}"></td>
                            </tr>
                            <tr>
                                <th>Amount</th>
                                <td class="text-danger fw-bold" th:text="${'â‚¹' + transaction.amount}"></td>
                            </tr>
                            <tr>
                                <th>Date and Time</th>
                                <td>
                                    <span th:text="${transaction.date}"></span>
                                    <span class="ms-2" th:text="${transaction.time}"></span>
                                </td>
                            </tr>
                            <tr>
                                <th>Transaction Type</th>
                                <td class="text-danger fw-bold">Transfer</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="mt-4 d-flex justify-content-center gap-3">
                <a href="/janta-bank" class="btn btn-success">
                    <i class="bi bi-house-door-fill me-1"></i> Back Home
                </a>
                <button class="btn btn-secondary" onclick="downloadPDF()">
                    <i class="bi bi-download me-1"></i> Download Receipt
                </button>
            </div>
        </div>
    </div>

    <div th:insert="~{@{reusable-code/footer}}"></div>

    <script>
        function downloadPDF() {
            const element = document.getElementById('receipt-content');
            const opt = {
                margin:       0.5,
                filename:     'transfer_receipt.pdf',
                image:        { type: 'jpeg', quality: 0.98 },
                html2canvas:  { scale: 2 },
                jsPDF:        { unit: 'in', format: 'letter', orientation: 'portrait' }
            };
            html2pdf().set(opt).from(element).save();
        }
    </script>
</body>
</html>
